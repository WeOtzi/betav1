<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WE OTZI | Support Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/shared/css/quotations.css">
    <link rel="stylesheet" href="/shared/css/support-dashboard.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
    <script src="/shared/js/config-manager.js"></script>
</head>
<body>
    <header class="top-nav-header">
        <div class="header-edition-info">
            Edicion Bauhaus | Support Dashboard
        </div>
        <div class="nav-row">
            <div class="nav-col">
                <div class="zoom-controls">
                    <button class="zoom-btn" onclick="zoomOut()" aria-label="Reducir zoom">-</button>
                    <button class="zoom-btn" onclick="zoomIn()" aria-label="Aumentar zoom">+</button>
                </div>
            </div>
            <div class="nav-col">
                <button class="theme-toggle" onclick="toggleTheme()" aria-label="Cambiar modo">O</button>
            </div>
        </div>
    </header>

    <div class="monolith-wrapper">
        <aside>
            <div class="logo-box"></div>
            <a href="#" class="nav-item nav-menu-item active" data-tab="artists" onclick="switchTab('artists'); updateSidebarActive(this);">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                    <circle cx="9" cy="7" r="4"/>
                </svg>
                ARTISTS
            </a>
            <a href="#" class="nav-item nav-menu-item" data-tab="quotes" onclick="switchTab('quotes'); updateSidebarActive(this);">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                    <polyline points="14 2 14 8 20 8"/>
                </svg>
                QUOTES
            </a>
            <a href="#" class="nav-item nav-menu-item" data-tab="tickets" onclick="switchTab('tickets'); updateSidebarActive(this);">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                </svg>
                TICKETS
            </a>
            <a href="#" class="nav-item nav-menu-item" data-tab="sessions" onclick="switchTab('sessions'); updateSidebarActive(this);">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 20h9"/>
                    <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/>
                </svg>
                SESSIONS
            </a>
            <div class="nav-divider"></div>
            <button class="nav-item nav-logout" onclick="handleLogout()">LOGOUT</button>
        </aside>

        <main>
            <header>
                <div class="dash-title">
                    <h1>Support<br>Dashboard</h1>
                </div>
                <div class="artist-meta">
                    <p id="logged-as">LOGGED_AS: SUPPORT</p>
                    <p id="status-indicator">STATUS: ONLINE</p>
                </div>
            </header>

            <!-- Stats Strip -->
            <section class="stats-strip">
                <div class="stat-card" id="stat-artists-card" onclick="switchTab('artists')">
                    <span class="stat-label">Total Artists</span>
                    <span class="stat-value" id="stat-total-artists">0</span>
                </div>
                <div class="stat-card" style="background: var(--bauhaus-yellow);" id="stat-quotes-card" onclick="switchTab('quotes')">
                    <span class="stat-label">Total Quotes</span>
                    <span class="stat-value" id="stat-total-quotes">0</span>
                </div>
                <div class="stat-card" style="background: var(--bauhaus-blue); color: white;" id="stat-tickets-card" onclick="switchTab('tickets')">
                    <span class="stat-label">Tickets</span>
                    <span class="stat-value" id="stat-total-tickets">0</span>
                </div>
                <div class="stat-card" style="background: var(--bauhaus-red); color: white;">
                    <span class="stat-label">Pending</span>
                    <span class="stat-value" id="stat-pending">0</span>
                </div>
            </section>

            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-btn active" data-tab="artists" onclick="switchTab('artists')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                        <circle cx="9" cy="7" r="4"/>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                    </svg>
                    ARTISTS
                </button>
                <button class="tab-btn" data-tab="quotes" onclick="switchTab('quotes')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                        <polyline points="14 2 14 8 20 8"/>
                        <line x1="16" y1="13" x2="8" y2="13"/>
                        <line x1="16" y1="17" x2="8" y2="17"/>
                    </svg>
                    QUOTES
                </button>
                <button class="tab-btn" data-tab="tickets" onclick="switchTab('tickets')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                    </svg>
                    TICKETS
                </button>
                <button class="tab-btn" data-tab="sessions" onclick="switchTab('sessions')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 20h9"/>
                        <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/>
                    </svg>
                    SESSIONS
                </button>
            </div>

            <!-- Table Toolbar -->
            <div class="table-toolbar">
                <div class="toolbar-search">
                    <div class="search-wrapper">
                        <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                            <circle cx="11" cy="11" r="8"/>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                        </svg>
                        <input type="text" id="search-input" placeholder="BUSCAR..." class="toolbar-input">
                    </div>
                </div>
                <div class="toolbar-filters" id="toolbar-filters"></div>
                <button class="action-btn create-btn" id="create-new-btn" onclick="openCreateModal()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                        <line x1="12" y1="5" x2="12" y2="19"/>
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                    NEW
                </button>
            </div>

            <!-- Data Table Container -->
            <div class="table-container" id="table-container">
                <div class="table-header" id="table-header"></div>
                <div id="table-body">
                    <div class="loading-placeholder" style="padding: 2rem; text-align: center; font-family: 'Space Mono', monospace;">
                        LOADING_DATA...
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Detail Drawer -->
    <input type="checkbox" id="drawer-toggle" class="drawer-trigger">
    <label for="drawer-toggle" class="drawer-backdrop"></label>
    <div class="detail-drawer">
        <label for="drawer-toggle" class="close-drawer">&times;</label>
        <div class="drawer-content" id="drawer-content"></div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirm-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container" style="max-width: 400px;">
            <div class="modal-header">
                <h3 id="confirm-modal-title">Confirmar Accion</h3>
            </div>
            <div class="modal-body">
                <p id="confirm-modal-message">Esta seguro de realizar esta accion?</p>
            </div>
            <div class="modal-footer" style="display: flex; gap: 1rem;">
                <button class="action-btn" onclick="closeConfirmModal()">CANCELAR</button>
                <button class="action-btn save-btn" id="confirm-modal-btn" onclick="confirmAction()">CONFIRMAR</button>
            </div>
        </div>
    </div>

    <!-- Unauthorized Modal -->
    <div id="unauthorized-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container" style="max-width: 400px;">
            <div class="modal-header" style="background: var(--bauhaus-red); color: white;">
                <h3>Acceso No Autorizado</h3>
            </div>
            <div class="modal-body">
                <p style="text-align: center; margin: 1rem 0;">
                    No tienes permisos para acceder a esta area.<br>
                    Contacta al administrador si crees que esto es un error.
                </p>
            </div>
            <div class="modal-footer">
                <button class="action-btn" onclick="window.location.href='/registerclosedbeta'" style="width: 100%;">VOLVER AL INICIO</button>
            </div>
        </div>
    </div>

    <!-- Create Record Modal -->
    <div id="create-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container create-modal-container">
            <button class="modal-close-btn" onclick="closeCreateModal()" aria-label="Cerrar">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
            <div class="modal-header" id="create-modal-header">
                <h3 id="create-modal-title">Create New Record</h3>
            </div>
            <div class="modal-body" id="create-modal-body"></div>
            <div class="modal-footer" id="create-modal-footer">
                <button class="action-btn" onclick="closeCreateModal()">CANCELAR</button>
                <button class="action-btn save-btn" onclick="submitCreateForm()">CREAR</button>
            </div>
        </div>
    </div>

    <script src="/shared/js/support-dashboard.js"></script>
</body>
</html>
